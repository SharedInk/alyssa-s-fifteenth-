<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Happy Birthday Alyssa</title>
  <link rel="stylesheet" href="styles.css" />
</head>

<body>

<!-- ENTRY PAGE -->
<section id="entry" class="entry">
  <div class="entry-box">
    <h1>HAPPY BIRTHDAY ALYSSA</h1>
    <p>if you don't type your name it doesn't let u enter.</p>

    <input id="nameInput" type="text" placeholder="Alyssa" autocomplete="off" />
    <button id="enterBtn" type="button">Enter</button>

    <p class="tiny">or press enter on your keyboard</p>
    <p id="errorMsg" class="error hidden">you have to type your name first</p>
  </div>
</section>

<!-- MAIN SITE -->
<div id="site" class="hidden">

  <header class="topbar">
    <div class="brand">
      <div class="mark"></div>
      <div>
        <div class="title" id="titleText">happy birthday alyssa</div>
        <div class="subtitle">i made a static site for u </div>
      </div>
    </div>

    <nav class="nav">
      <button class="tab active" type="button" data-page="home">Home</button>
      <button class="tab" type="button" data-page="card">Card</button>
      <button class="tab" type="button" data-page="game">Game</button>
    </nav>
  </header>

  <main class="wrap">

    <!-- HOME -->
    <section id="home" class="page show">
      <div class="grid">
        <div class="panel panel-blue">
          <h2 id="homeHeading">youâ€™re 15!</h2>
          <p>try clicking anywhere on the screen because i did something, also this is only my 2nd time making something like this so if it dont work its my bad :) also try clicking onto the top right corner!</p>

          <img src="snoopy.gif" alt="snoopy gif" class="home-gif" />
          <p class="micro">If the gif isn't uploaded yet, itâ€™ll be blank.</p>
        </div>

        <div class="panel panel-ice">
          <div class="photo-frame">
            <img src="alyssa.jpg" alt="Alyssa" />
          </div>
          <div class="caption">
            <span class="caption-title" id="captionName">Alyssa</span>
            <span class="caption-sub">15 today</span>
          </div>
        </div>
      </div>
    </section>

    <!-- CARD -->
    <section id="card" class="page">
      <div class="panel panel-ice single">
        <h2>Card</h2>

        <div class="card-preview">
          <div class="card-top">
            <div class="stamp"></div>
            <div>
              <div class="card-to" id="cardToLine">To: Alyssa</div>
              <div class="card-from">From: lisa:)</div>
            </div>
          </div>

          <div class="card-body">
HAPPY birthday Alyssa! You are so young wth but still halfway to 30 (stole a leaf out of Natalieâ€™s book there) anyways I wish 15 treats you well and I know you will accomplish everything you want! You are actually so incredibly smart and amazing and fun to be around, and youâ€™re also so talented at multiple things and debating I feel like you should ackowncegde that wayyy more often. Im super grateful to have u in the friendgroup especially when it comes to werewolf ha.ha. ha. ANYWAYS. I HOPE U HAVE AN AMAZING YEAR ILYSM AND BYE! (Also please try and refresh if this site is not bringing you to any other section apart from this because ive tried to recode this stupid branch multiple times and my coding WONT WORK BRUH. So if this crashes I am very very sory but I aint that advanced for all this sory :)
          </div>

          <div class="card-bottom">
            <span class="signature">â€” you</span>
          </div>
        </div>
      </div>
    </section>

    <!-- GAME -->
    <section id="game" class="page">
      <div class="panel panel-blue single">
        <h2>Mini Game</h2>
        <p class="subtle">this was so hard to code pls tell me it worked. don't mind the best score i was testing it</p>

        <canvas id="gameCanvas" width="900" height="260" class="game-canvas"></canvas>

        <div class="game-row">
          <button id="gameStart" class="tab active" type="button">Start</button>
          <button id="gameReset" class="tab" type="button">Reset</button>

          <div class="game-score">
            <span>Score: <b id="scoreText">0</b></span>
            <span class="sep">â€¢</span>
            <span>Best: <b id="bestText">0</b></span>
          </div>
        </div>

        <p class="tiny">If you lose, press Start again.</p>
      </div>
    </section>

  </main>

  <footer class="footer">
    <span>this took way too long</span>
  </footer>
</div>

<div id="fx" aria-hidden="true"></div>

<!-- SCRIPT AT VERY BOTTOM (most reliable) -->
<script>
  // ENTRY + NAV
  const entry = document.getElementById("entry");
  const site = document.getElementById("site");
  const nameInput = document.getElementById("nameInput");
  const enterBtn = document.getElementById("enterBtn");
  const errorMsg = document.getElementById("errorMsg");

  const titleText = document.getElementById("titleText");
  const homeHeading = document.getElementById("homeHeading");
  const captionName = document.getElementById("captionName");
  const cardToLine = document.getElementById("cardToLine");

  let currentPage = "home";

  function enterSite() {
    const name = (nameInput.value || "").trim();
    if (!name) {
      errorMsg.classList.remove("hidden");
      return;
    }
    errorMsg.classList.add("hidden");

    titleText.textContent = "happy birthday " + name.toLowerCase();
    homeHeading.textContent = "youâ€™re 15, " + name + "!!";
    captionName.textContent = name;
    cardToLine.textContent = "To: " + name;

    entry.style.display = "none";          // SUPER reliable hide
    site.classList.remove("hidden");
    currentPage = "home";
  }

  enterBtn.addEventListener("click", enterSite);
  nameInput.addEventListener("keydown", (e) => {
    if (e.key === "Enter") enterSite();
  });

  const tabs = document.querySelectorAll(".tab[data-page]");
  const pages = document.querySelectorAll(".page");

  tabs.forEach(tab => {
    tab.addEventListener("click", () => {
      tabs.forEach(t => t.classList.remove("active"));
      pages.forEach(p => p.classList.remove("show"));

      tab.classList.add("active");
      document.getElementById(tab.dataset.page).classList.add("show");
      currentPage = tab.dataset.page;

      if (currentPage === "game") drawGame();
    });
  });

  // CLICK EFFECT (appears where you click)
  const fx = document.getElementById("fx");

  function spawnClickSprite(x, y) {
    const symbols = (currentPage === "card") ? ["â™¡","â™¥"] : ["ðŸ¾","â˜ï¸Ž","âœ¦"];
    const s = document.createElement("div");
    s.className = "sprite";
    s.textContent = symbols[Math.floor(Math.random() * symbols.length)];
    s.style.left = x + "px";
    s.style.top = y + "px";

    const size = 14 + Math.random() * 12;
    s.style.fontSize = size + "px";

    const r1 = (Math.random() * 90 - 45);
    const r2 = r1 + (Math.random() * 140 - 70);

    s.style.transform = `translate(-50%, -50%) rotate(${r1}deg)`;
    s.style.opacity = "0.95";
    fx.appendChild(s);

    requestAnimationFrame(() => {
      s.style.opacity = "0";
      s.style.transform = `translate(-50%, -50%) translateY(-120px) rotate(${r2}deg)`;
    });

    setTimeout(() => s.remove(), 1700);
  }

  // GAME STATE
  const canvas = document.getElementById("gameCanvas");
  const ctx = canvas.getContext("2d");

  const scoreText = document.getElementById("scoreText");
  const bestText = document.getElementById("bestText");
  const gameStart = document.getElementById("gameStart");
  const gameReset = document.getElementById("gameReset");

  let running = false;
  let gameOver = false;
  let lastTime = 0;

  let score = 0;
  let best = Number(localStorage.getItem("alyssaGameBest") || "0");
  bestText.textContent = best;

  const world = { groundY: 205, speed: 340, gravity: 1900, jumpV: 720 };
  const player = { x: 120, y: world.groundY, vy: 0, r: 18, onGround: true };
  let obstacles = [];
  let spawnTimer = 0;

  function resetGame() {
    running = false;
    gameOver = false;
    score = 0;
    scoreText.textContent = "0";
    world.speed = 340;
    player.y = world.groundY;
    player.vy = 0;
    player.onGround = true;
    obstacles = [];
    spawnTimer = 0;
    drawGame();
  }

  function startGame() {
    resetGame();
    running = true;
    lastTime = performance.now();
    requestAnimationFrame(loop);
  }

  function jumpGame() {
    if (!running) return;
    if (player.onGround) {
      player.vy = -world.jumpV;
      player.onGround = false;
    }
  }

  function spawnObstacle() {
    const size = 18 + Math.random() * 10;
    obstacles.push({
      x: canvas.width + 40,
      y: world.groundY,
      w: size * 1.1,
      h: size,
      kind: Math.random() < 0.5 ? "â˜ï¸Ž" : "ðŸ¾"
    });
  }

  function collideCircleRect(c, r) {
    const cx = c.x, cy = c.y, rad = c.r;
    const rx = r.x, ry = r.y - r.h, rw = r.w, rh = r.h;
    const closestX = Math.max(rx, Math.min(cx, rx + rw));
    const closestY = Math.max(ry, Math.min(cy, ry + rh));
    const dx = cx - closestX;
    const dy = cy - closestY;
    return (dx*dx + dy*dy) <= rad*rad;
  }

  function update(dt) {
    if (gameOver) return;

    world.speed += dt * 6;

    player.vy += world.gravity * dt;
    player.y += player.vy * dt;

    if (player.y >= world.groundY) {
      player.y = world.groundY;
      player.vy = 0;
      player.onGround = true;
    }

    spawnTimer -= dt;
    if (spawnTimer <= 0) {
      spawnObstacle();
      spawnTimer = 0.95 + Math.random() * 0.75;
    }

    for (const ob of obstacles) ob.x -= world.speed * dt;
    obstacles = obstacles.filter(ob => ob.x + ob.w > -60);

    for (const ob of obstacles) {
      if (collideCircleRect(player, ob)) {
        gameOver = true;
        running = false;
        if (score > best) {
          best = score;
          localStorage.setItem("alyssaGameBest", String(best));
          bestText.textContent = String(best);
        }
      }
    }

    score += Math.floor(dt * 100);
    scoreText.textContent = String(score);
  }

  function drawGame() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ctx.fillStyle = "rgba(214,232,255,0.60)";
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    ctx.fillStyle = "rgba(20,20,20,0.15)";
    ctx.fillRect(0, world.groundY + 18, canvas.width, 3);

    ctx.font = "28px system-ui";
    ctx.textAlign = "center";
    ctx.textBaseline = "middle";
    ctx.fillText("ðŸ¶", player.x, player.y - 14);

    ctx.font = "26px system-ui";
    for (const ob of obstacles) {
      ctx.fillText(ob.kind, ob.x + ob.w/2, ob.y - ob.h/2);
    }

    ctx.textAlign = "left";
    ctx.textBaseline = "top";
    ctx.fillStyle = "rgba(20,20,20,0.7)";
    ctx.font = "14px system-ui";

    if (!running && !gameOver) ctx.fillText("Press Start, then click/tap to jump.", 16, 14);
    if (gameOver) {
      ctx.fillStyle = "rgba(20,20,20,0.85)";
      ctx.font = "18px system-ui";
      ctx.fillText("Game over â€” press Start to try again.", 16, 14);
    }
  }

  function loop(t) {
    if (!running) return;
    const dt = Math.min(0.033, (t - lastTime) / 1000);
    lastTime = t;
    update(dt);
    drawGame();
    requestAnimationFrame(loop);
  }

  gameStart.addEventListener("click", startGame);
  gameReset.addEventListener("click", resetGame);

  // Pointer: show emoji always, and jump only in-game
  document.addEventListener("pointerdown", (e) => {
    const tag = e.target.tagName;
    if (["BUTTON","INPUT","TEXTAREA"].includes(tag)) return;

    if (currentPage === "game") jumpGame();
    spawnClickSprite(e.clientX, e.clientY);
  });

  resetGame();
</script>

</body>
</html>
